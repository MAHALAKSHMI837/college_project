<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <link rel="stylesheet" href="/user/user.css">
  <title>Continuous 2FA Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<div class="container">
  <div class="topbar">
    <div class="header-top">
      <div class="logo"><span class="dot"></span> Continuous 2FA <span class="badge">Wi‚ÄëFi + Audio + Watch</span></div>
      <div class="controls">
        <input id="search" class="search" placeholder="Search events‚Ä¶"/>
        <button id="btnStart" class="btn">Start Stream</button>
        <button id="btnStop" class="btn ghost">Stop Stream</button>
        <button id="btnLogout" class="btn ghost" style="margin-left: 10px;">Logout</button>
        <div class="user-info">
          <span id="userWelcome">Welcome, User</span>
        </div>
      </div>
    </div>
    <div class="navigation">
      <span class="nav-items">
        <a href="/" class="nav-link active">Dashboard</a> ¬∑ 
        <a href="/user/streams.html" class="nav-link">Streams</a> ¬∑ 
        <a href="/user/decisions.html" class="nav-link">Decisions</a> ¬∑ 
        <a href="/user/settings.html" class="nav-link">Settings</a>
      </span>
    </div>
  </div>

  <aside class="sidebar">
    <div class="section">
      <h3>Sampling</h3>
      <div class="small">Wi‚ÄëFi: <span id="cfgWifiInt">60s</span></div>
      <div class="small">Audio: <span id="cfgAudioInt">300s</span></div>
      <div class="small">Watch: <span id="cfgWatchInt">30s</span></div>
    </div>
    <div class="section">
      <h3>Thresholds</h3>
      <div class="small">Min Trust: <span id="cfgTrust">0.65</span></div>
      <div class="small">Watch Proximity (m): <span id="cfgProx">3.0</span></div>
    </div>
    <div class="section">
      <h3>Session</h3>
      <div class="small">User: <b id="user">Loading...</b></div>
      <div class="small">Device: <b id="device">Loading...</b></div>
      <div class="small">Status: <span id="status" class="status">stopped</span></div>
    </div>
  </aside>

  <main class="main">
    <section class="grid cols-3">
      <div class="card trust-card">
        <h3>üõ°Ô∏è Trust Score</h3>
        <div class="trust-display">
          <div class="trust-circle">
            <svg class="progress-ring" width="120" height="120">
              <circle class="progress-ring-bg" cx="60" cy="60" r="50"></circle>
              <circle class="progress-ring-fill" cx="60" cy="60" r="50" id="trustProgress"></circle>
            </svg>
            <div class="trust-value">
              <span class="big" id="trustScore">0.85</span>
              <span class="trust-label">TRUST</span>
            </div>
          </div>
          <div class="trust-status">
            <div class="status-indicator" id="trustStatus">üü¢ SECURE</div>
            <div class="confidence-level" id="confidenceLevel">High Confidence</div>
          </div>
        </div>
        <div class="trust-factors">
          <div class="factor">
            <span class="factor-icon">üì∂</span>
            <span class="factor-name">Wi-Fi</span>
            <span class="factor-value" id="wifiScore">92%</span>
          </div>
          <div class="factor">
            <span class="factor-icon">üéµ</span>
            <span class="factor-name">Audio</span>
            <span class="factor-value" id="audioScore">78%</span>
          </div>
          <div class="factor">
            <span class="factor-icon">‚åö</span>
            <span class="factor-name">Watch</span>
            <span class="factor-value" id="watchScore">95%</span>
          </div>
        </div>
        <div class="fixed-chart">
          <canvas id="trustChart"></canvas>
        </div>
      </div>

      <div class="card">
        <h3>Wi‚ÄëFi RSSI (Top 5 APs)</h3>
        <div class="small">Lower is weaker. Stable fingerprints ‚Üí higher confidence.</div>
        <div class="fixed-chart">
          <canvas id="wifiChart"></canvas>
        </div>
      </div>

      <div class="card">
        <h3>Audio MFCC Entropy</h3>
        <div class="small">Ambient sound pattern analysis</div>
        <div class="fixed-chart">
          <canvas id="audioChart"></canvas>
        </div>
      </div>
    </section>

    <section class="card">
      <h3>Recent Decisions</h3>
      <table>
        <thead>
          <tr>
            <th>Time</th>
            <th>Trust</th>
            <th>Result</th>
            <th>Reason</th>
          </tr>
        </thead>
        <tbody id="decisionsBody">
          <tr>
            <td colspan="4" style="text-align: center; color: var(--muted);">No decisions yet. Start the stream to begin monitoring.</td>
          </tr>
        </tbody>
      </table>
    </section>

    <section class="card">
      <h3>Live Stream Analytics</h3>
      <div class="small">Real-time behavioral biometric monitoring</div>
      <hr/>
      <div class="grid cols-3">
        <div>
          <div class="small">Watch Proximity (m)</div>
          <div class="fixed-chart">
            <canvas id="watchChart"></canvas>
          </div>
        </div>
        <div>
          <div class="small">Feature Drift Detection</div>
          <div class="fixed-chart">
            <canvas id="driftChart"></canvas>
          </div>
        </div>
        <div>
          <div class="small">Decision Distribution</div>
          <div class="fixed-chart">
            <canvas id="histChart"></canvas>
          </div>
        </div>
      </div>
    </section> 

    <footer class="small">
      Continuous 2FA Authentication System ‚Ä¢ Real-time Behavioral Biometrics
    </footer>
  </main>
</div>

<script src="/user/app.js"></script>
</body>
</html>